# 频域滤波



[TOC]

## 1. 频域

信号处理是采用**不同频率的正弦波**的叠加来逼近模拟任何周期函数。信号频谱$X(f)$代表了信号在不同频率分量的成分的大小，可以提供比时域波形更直观、丰富的信息。在频域中可以很容易的去除一些特定的频率成分，即频域滤波。

## 2. 傅立叶变换

### 2.1 一维连续傅立叶变换

进行从空域向频域的连续变换:

$$
F(u) = \int _{x=-\infty}^{\infty}f(x)e^{-2j\pi ux}dx
$$


其中$j$为虚数单位，$x,u$均为实数，对应的傅立叶逆变换将图像的频率分布函数变换为灰度分布函数。
$$
f(x) = \int _{u = -\infty} ^{\infty} F(u) e ^{2j\pi ux} du
$$


基函数:$e ^{-2j \pi ux}$ 可以使用欧拉公式:

$$
e ^{j \theta} = cos \theta + j sin\theta
$$
![oula](http://media.innohub.top/190521-oula.png)

**注意逆变换基函数没有负号**

### 2.2 二维连续傅里叶变换

![二维](http://media.innohub.top/190521-fu2.png)

### 2.3 离散傅立叶变换（DFT）

![DFT](http://media.innohub.top/190521-dft.png)

二维变换:

![二维DFT](http://media.innohub.top/190521-dft2.png)

DFT计算得到频域的分量后，可以计算对应的**傅立叶频谱**:

$$
|F(u, v)| = [R ^2(u, v) + I ^2 (u,v)]^2
$$

R,I分别为实部、虚部。

**相位谱**

$$
\phi (u, v) = tan ^{-1} [\frac{I(u,v)}{R(u,v)}]
$$

**功率谱**

$$
P(u,v) = |F(u,v)| ^2
$$

#### 傅立叶频谱图的移中

移中处理：将F(0,0)平移到F(M/2, N/2)

**好处**：可以清晰地看出图像的频率分布，更加直观、更符合周期性原理；可以分离出有周期性的干扰信号，例如正弦干扰

**从频谱图可以直观得到图像的能量分布，图像的能量大多集中在低频分量，细节显示在高频分量**

+ 如果频谱图中暗点多，那么图像比较柔和
+ 如果频谱图中亮点多，那么图像比较尖锐、边界分明，边界两边差异较大

#### 傅里叶谱的分析

+ F(0,0)是**整个图像的平均灰度**，也是**最低频率**
+ (u,v)越靠近（0,0），频率越低，包含低频信息，**代表灰度缓慢变化的低频区域**
+ （u,v）远离（0,0），频率越高，包含高频信息，代表灰度变化剧烈的区域，例如边缘、纹理、噪声
+ **频谱图中明显频率变化的方向与原图像中的地物方向垂直**

## 3. 二维傅立叶变换的性质

### 3.1 线性性

傅立叶变换线性可加

### 3.2 分配率

对于加法具有分配率，对于乘法没有分配率

### 3.3 平移

进行傅里叶变换前，原函数乘以一个指数项，再进行傅立叶变换，可以将频域原点移至($u_0, v_0$).

对于傅立叶逆变换具有同样的性质

![平移](http://media.innohub.top/190521-tran.png)

### 3.4 缩放

![scale](http://media.innohub.top/190521-sca.png)

### 3.5 旋转

使用极坐标形式表示傅里叶变换，空域f(x, y)旋转$\theta_0$角，则F(u, v)也旋转相同的角度。

极坐标表示:

+ $x = r cos\theta \;\;\; y = rsin\theta$
+ $u = \omega cos \phi \;\;\; v = \omega sin \phi$
+ $f(x,y);F(u,v) => f(r,\theta), F(\omega, \phi)$

**傅里叶谱可以作为图像的强度指标，图像的亮度正比于幅度值。幅度谱常常具有巨大的动态范围；金最亮的部分可见，所以进行对数变换可以提高其细节的显示能力。**
$$
D(u, v) = clog(1 + |F(u, v)|)
$$

### 3.6 可分离性

二维离散傅立叶变换可以表示为可分离的形式:
$$
F(u,v) = \frac{1}{M} \sum _{x =0} ^{M-1} F(x, v) e ^{-2j \pi ux / M}
$$
其中:
$$
F(x, v) = \frac{1}{N} \sum _{y =0} ^{N-1} f(x,y)e ^{-2j \pi vy /N}
$$
**因此对于任意的二维离散傅立叶变换，可以先沿着每一行进行1维的离散傅立叶变换；在沿着每一列进行变换**

### 3.7 卷积理论

傅里叶变换对的卷积定理：

```
空域上的函数的卷积等价于傅立叶变换后频域函数的乘积；
频域的卷积等价于傅立叶逆变换后空域函数的乘积
```



### 3.8 快速傅里叶变换FFT

## 4. 频域滤波

利用傅里叶变换的卷积理论，空域的卷积操作等价于傅立叶变换后的函数的乘积。所以只需要确定频域的转移函数，在频域进行处理后载进行逆变换，得到最终的$g(x, y)$.基本的滤波器:

+ 低通
+ 高通
+ 带通、带阻
+ 同态

转移函数的设计：允许一部分频率通过，限制或者消除一些频率分量得到所需的增强效果。

### 4.1 陷波滤波器 Notch Filter

频谱中心置为0，其他位置置为1.导致了总体灰度值的下降，强制将平均灰度值置为0；突出边缘。

可以用于去除图像中的波纹效应。

+ 除去了一个特定范围的频率
+ 不影响图像的对比度
+ 保护了图像的高频信息

### 4.2 低通滤波器

用于去除特定范围的高频分量。消除噪声，平滑细节。使噪声，细节，为轮廓效应减少。通过牺牲清晰度为代价换取的去噪结果。

1. 理想的低通滤波器(ILBP):

通过设置一个截止频率，如果大于该频临的成分都置为0
$$
H(u, v)=\left\{
\begin{aligned}
1 &  & if D(u, v) \le D_0 \\
0 &  & if D(u, v) \ge D_0 \\

\end{aligned}
\right.
$$
其中$D(u, v)$代表了频率平面上的点到原点的欧氏距离。理想滤波器的平滑处理清晰，但是在处理过程中会出现较严重的**模糊以及振铃现象**。截止频率越小振铃越明显。对于理想的低通滤波器。可以根据设定的截止频率确定所保留的能量比例。保留能量越少，则振铃现象越明显。

**振铃现象的原因**

将理想的低通滤波转移函数进行傅立叶逆变换得到的是**一系列明暗相同的同心圆环，使用这样的滤波器再与原图进行卷积操作就会产生振铃现象**。同心圆环的半径反比与截止频率$D_0$.所以截止频率越大，半径越小，也就没有振铃现象。

2. 巴特沃兹低通滤波器(BLBP)

   又被称为最大平坦滤波器，与理想滤波器不同，其通带与阻带没有明显的不连续性，在其通带与阻带之间有一个平滑的过渡带。
   $$
   H(u, v) = \frac{1}{1+[D(u, v)/D_0]^{2n}}
   $$
   ![bate](http://media.innohub.top/190522-bater.png)

   

   小于截止频率，经过滤波器处理的值位于[1, 0.5)之间，大于截止频率时输出值为(0.5, 0).**其中n越大越接近理想低通滤波器**

   + 与理想滤波器相比，巴特沃兹滤波器处理图像的模糊程度降低，因为转移函数不是陡峭的截止特性，尾部会包含大量的高频成分
   + 巴特沃兹滤波器不会产生振铃现象，因其在阻带与通带之间有一平滑过渡

3. 高斯低通滤波器(GLBP)
   $$
   H(u, v) = e ^{-D^2 (u, v) / 2 \sigma ^2}
   $$
   其中$\sigma$是高斯函数的方差，D(u ,v)是频率平面上的距原点的距离。也可以将$\sigma$定义为截止频率:
   $$
   H(u, v) = e ^{-D^2 (u, v) / 2 D_0 ^2}
   $$
   ![gaussian](http://media.innohub.top/190522-gauss.PNG)

   

### 4.3 高通滤波器

实际上是以上频率域的低通滤波器的逆运算。

1. 理想高通滤波器

   即理想低通滤波器的逆操作。IHPF = 1 - ILPF.同样产生振铃现象。截止频率越小，振铃现象越明显。

2. 巴特沃兹高通滤波器
   $$
   H(u, v) = \frac{1}{1+[D_0 / D(u, v)] ^{2n}}
   $$
   与巴特沃兹低频滤波器一样，通过在高频滤波器的通带与阻带之间添加一个平滑的过渡带，从而保留一部分的低频分量，没有明显的不连续。从而避免了振铃现象。截止频率越大。边缘锐化效果越不明显，图像的亮度越低。

3. 高斯高通滤波器
   $$
   H(u, v)  = 1 - e ^{-D^2(u, v) / 2\sigma ^2}
   $$
   将$\sigma$写作截止频率：
   $$
   H(u,v) = 1 - e ^{-D^2(u,v)/2D_0^2}
   $$
   由于频域高通滤波会将大多数的低频分量移除，导致图像的边缘加强但是光滑区域灰度减弱甚至变为黑色。**可以在高斯滤波的转移函数上加一个常数，以将一些低频分量加回去，得到高频增强滤波器。**
   $$
   \hat{g}(x, y) = g(x, y) + c×f(x, y) 
   $$
   也可以给转移函数添加一个系数:
   $$
   He(x, y) = k * H(u, v) + C \\
   Ge(x, y) = k * g(u, v) + C*F(u, v)
   $$
   *g为高斯滤波后的图像*

4. 拉普拉斯高通滤波器
   
   空域上的拉普拉斯操作与频域上的傅立叶变换对:
   $$
   \nabla ^2 f(x, y) \\ -[(u - M/2) ^2 + (v - N/2) ^2]F(u,v)
   $$
   
5. 高增益滤波器

   基本的高通滤波等价于1减去低通滤波的结果，而高频提升滤波器等于原始图像乘以一个系数A再减去低通结果；高频重点滤波实在高频滤波的基础上添加系数

   ![高频](http://media.innohub.top/190522-high.png)



### 4.4 同态滤波

对于灰度动态范围较大，感兴趣的灰度范围较小时使用。**压缩灰度动态范围，让感兴趣的部分灰度级扩展。**

通态滤波是一种在频域中同时将**亮度的范围进行压缩，同时将图像对比度增强的方法。**也就是把频率过滤与灰度变换结合起来。

以照明反射模型作为频域处理的基础，自然景物的图像可以表示为他的**照度分量f(x, y)**以及**反射分量fr(x, y)**的乘积：

+ 照度分量集中在低频段，描述景物照明，与景物无关

+ 反射分量集中在景物的高频段，描述景物细节，与照明无关

利用对数运算将两部分分开，分别世家不同的影响，压制低频放大高频。

![同态](http://media.innohub.top/190522-homo.png)













